# PUA CLI

> ä¸€ä¸ªè¶£å‘³æ€§ AI CLI å·¥å…·ï¼Œå…·æœ‰ä¸¤ç§è§’è‰²æ¨¡å¼ï¼š**è€æ¿æ¨¡å¼**å’Œ**å‘˜å·¥æ¨¡å¼**ã€‚

## ç•Œé¢é¢„è§ˆ

### é…ç½®å®Œæˆç•Œé¢
![Chat Mode](screenshots/chat-mode.png)

### äº¤äº’å¯¹è¯ç•Œé¢
![Chat Dialogue](screenshots/chat-dialogue.png)

---

## æŠ€æœ¯åŸç†

> ğŸ“˜ **[è¯¦ç»†æŠ€æœ¯æ–‡æ¡£](docs/TECHNICAL_PRINCIPLES.md)** | æœ¬é¡¹ç›®æ˜¯ä¸€ä¸ªå®Œæ•´çš„ CLI å·¥å…·å¼€å‘å®è·µï¼Œæ¶µç›–ä»¥ä¸‹æ ¸å¿ƒæŠ€æœ¯ï¼š

æœ¬é¡¹ç›®æ˜¯ä¸€ä¸ªå®Œæ•´çš„ CLI å·¥å…·å¼€å‘å®è·µï¼Œæ¶µç›–ä»¥ä¸‹æ ¸å¿ƒæŠ€æœ¯ï¼š

### æ¶æ„è®¾è®¡

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                      PUA CLI æ¶æ„                      â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                         â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”              â”‚
â”‚  â”‚ CLI Layer  â”‚â”€â”€â”€â”€â”‚ Config Layer â”‚              â”‚
â”‚  â”‚ (Commander) â”‚    â”‚ (Settings)   â”‚              â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”˜    â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”˜              â”‚
â”‚         â”‚                    â”‚                            â”‚
â”‚         â–¼                    â–¼                            â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”              â”‚
â”‚  â”‚ Prompt Layerâ”‚â”€â”€â”€â”€â”‚  LLM Layer   â”‚              â”‚
â”‚  â”‚ (Boss/Empl)â”‚    â”‚ (Factory)    â”‚              â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”˜              â”‚
â”‚                            â”‚                            â”‚
â”‚                    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”              â”‚
â”‚                    â”‚  Zhipu  â”‚  OpenAI  â”‚              â”‚
â”‚                    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜              â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### æ ¸å¿ƒæŠ€æœ¯ç‚¹

#### 1. CLI æ¡†æ¶ - Commander.js
```typescript
// å‘½ä»¤å®šä¹‰æ¨¡å¼
program
  .command('chat')
  .option('-r, --role <boss|employee>')
  .action(async (options) => {
    // å‘½ä»¤å¤„ç†é€»è¾‘
  });
```

**å­¦ä¹ è¦ç‚¹**ï¼š
- å­å‘½ä»¤ç³»ç»Ÿè®¾è®¡
- å‚æ•°è§£æå’ŒéªŒè¯
- å¸®åŠ©ä¿¡æ¯è‡ªåŠ¨ç”Ÿæˆ

#### 2. äº¤äº’å¼è¾“å…¥ - @inquirer/prompts
```typescript
// é…ç½®å‘å¯¼ä½¿ç”¨
const provider = await select({
  message: 'é€‰æ‹© AI æœåŠ¡æä¾›å•†:',
  choices: [
    { name: 'æ™ºè°± AI', value: 'zhipu' },
    { name: 'OpenAI', value: 'openai' }
  ]
});
```

**å­¦ä¹ è¦ç‚¹**ï¼š
- äº¤äº’å¼é€‰æ‹©é¢˜è®¾è®¡
- è¾“å…¥éªŒè¯
- ç”¨æˆ·ä½“éªŒä¼˜åŒ–

#### 3. å¤š Provider æ¶æ„ - å·¥å‚æ¨¡å¼
```typescript
// LLM å·¥å‚æ¨¡å¼
export function createLLM(provider: ProviderType, options: LLMOptions): LLMBase {
  switch (provider) {
    case 'zhipu': return new ZhipuLLM(options);
    case 'openai': return new OpenAILLM(options);
  }
}
```

**å­¦ä¹ è¦ç‚¹**ï¼š
- æŠ½è±¡åŸºç±»è®¾è®¡
- å·¥å‚æ¨¡å¼åº”ç”¨
- ç»Ÿä¸€æ¥å£å°è£…

#### 4. æµå¼è¾“å‡ºå¤„ç† - SSE
```typescript
// å¤„ç† Server-Sent Events
await llm.chatStream(messages, (chunk) => {
  if (chunk.content) {
    process.stdout.write(chunk.content); // å®æ—¶è¾“å‡º
  }
});
```

**å­¦ä¹ è¦ç‚¹**ï¼š
- Server-Sent Events è§£æ
- æµå¼æ•°æ®å¤„ç†
- ç»ˆç«¯è¾“å‡ºæ§åˆ¶

#### 5. é…ç½®ç®¡ç† - å¤šå±‚ä¼˜å…ˆçº§
```
ä¼˜å…ˆçº§: CLIå‚æ•° > ç¯å¢ƒå˜é‡ > é¡¹ç›®é…ç½® > å…¨å±€é…ç½® > é»˜è®¤å€¼
```

**å­¦ä¹ è¦ç‚¹**ï¼š
- XDG Base Directory è§„èŒƒ
- é…ç½®æ–‡ä»¶å­˜å‚¨ç­–ç•¥
- é…ç½®åˆå¹¶é€»è¾‘

#### 6. ä¼šè¯å†å²ç®¡ç†
```typescript
class SessionManager {
  private messages: Message[] = [];

  addMessage(role: string, content: string) {
    this.messages.push({ role, content });
  }

  getHistory(): Message[] {
    return this.messages;
  }
}
```

**å­¦ä¹ è¦ç‚¹**ï¼š
- çŠ¶æ€ç®¡ç†
- ä¸Šä¸‹æ–‡ç»´æŠ¤
- å†å²è®°å½•æŒä¹…åŒ–

#### 7. æç¤ºè¯å·¥ç¨‹
```typescript
// è§’è‰²æç¤ºè¯æ¨¡æ¿
export function getBossSystemMessage(severity: string): string {
  const templates = {
    mild: "ä½ æ˜¯å–œæ¬¢è¯´æ•™ä½†ä¸ä¸¥å‰çš„è€æ¿...",
    extreme: "ä½ æ˜¯æåº¦æŒ‘å‰”ã€åˆ»è–„çš„è€æ¿..."
  };
  return templates[severity];
}
```

**å­¦ä¹ è¦ç‚¹**ï¼š
- æç¤ºè¯æ¨¡æ¿è®¾è®¡
- å‚æ•°åŒ–æ§åˆ¶
- è§’è‰²ä¸€è‡´æ€§

### æŠ€æœ¯æ ˆæ€»ç»“

| æŠ€æœ¯ | ç”¨é€” | å­¦ä¹ ä»·å€¼ |
|------|------|----------|
| TypeScript | ç±»å‹å®‰å…¨ | ç±»å‹ç³»ç»Ÿã€æ¥å£è®¾è®¡ |
| Commander.js | CLI æ¡†æ¶ | å‘½ä»¤è¡Œå·¥å…·å¼€å‘ |
| @inquirer/prompts | äº¤äº’å¼è¾“å…¥ | ç”¨æˆ·äº¤äº’è®¾è®¡ |
| Chalk | ç»ˆç«¯ç€è‰² | ç»ˆç«¯è¾“å‡ºç¾åŒ– |
| Node.js Streams | æµå¼å¤„ç† | æµæ•°æ®å¤„ç† |
| Fetch API | HTTP è¯·æ±‚ | å¼‚æ­¥ç¼–ç¨‹ |

---

## è§’è‰²ä»‹ç»

### è€æ¿æ¨¡å¼ ğŸ‘”
- å¯¹å‘˜å·¥çš„å·¥ä½œæ°¸è¿œä¸æ»¡æ„
- å–œæ¬¢ç”¨"ä¸ºä½ å¥½"æ¥åŒ…è£…æŒ‡è´£
- ç»å¸¸è¯´"å¹´è½»äººè¦å¤šé”»ç‚¼"
- å–œæ¬¢ç”»å¤§é¥¼ï¼Œä½†ä»ä¸å…‘ç°
- ç”¨è´¨ç–‘çš„è¯­æ°”è¯„ä»·ä¸€åˆ‡

### å‘˜å·¥æ¨¡å¼ ğŸ‘¤
- å¯¹è€æ¿çš„ä»»ä½•è¦æ±‚éƒ½è¯´"å¥½çš„"
- ä¹ æƒ¯æ€§é“æ­‰
- ä¸æ•¢è¡¨è¾¾çœŸå®æƒ³æ³•
- ç”¨å‘å¾®çš„è¯­æ°”å›åº”ä¸€åˆ‡
- ç»å¸¸åŠ ç­ï¼Œä»ä¸æ•¢æ‹’ç»

## å¿«é€Ÿå¼€å§‹

### ä¸€é”®å®‰è£…

```bash
# å…‹éš†é¡¹ç›®
git clone https://github.com/your-username/pua_cli.git
cd pua_cli

# å®‰è£…ä¾èµ–å¹¶æ„å»º
npm install && npm run build

# å…¨å±€å®‰è£…
npm install -g .
```

### é¦–æ¬¡ä½¿ç”¨

```bash
# å¯åŠ¨èŠå¤©ï¼ˆé¦–æ¬¡è¿è¡Œä¼šè‡ªåŠ¨è¿›å…¥é…ç½®å‘å¯¼ï¼‰
pua chat
```

é…ç½®å‘å¯¼ä¼šå¼•å¯¼ä½ ï¼š
- é€‰æ‹© AI æœåŠ¡æä¾›å•†ï¼ˆæ™ºè°± AI / OpenAIï¼‰
- è¾“å…¥ API Key
- è®¾ç½®é»˜è®¤æ¨¡å‹å’Œè§’è‰²

### ç«‹å³ä½“éªŒ

```bash
# è€æ¿æ¨¡å¼ - PUA åˆ«äºº
pua chat --role boss --severity extreme

# å‘˜å·¥æ¨¡å¼ - è¢« PUA
pua chat --role employee
```

#### å•æ¬¡æç¤ºæ¨¡å¼

```bash
# ç›´æ¥æé—®
pua prompt --role boss "ä»£ç å†™å®Œäº†"

# ç®¡é“è¾“å…¥ï¼ˆé€‚åˆè„šæœ¬è°ƒç”¨ï¼‰
echo "åŠ ç­" | pua prompt --role employee
```

## å¸¸ç”¨å‘½ä»¤

| å‘½ä»¤ | è¯´æ˜ |
|------|------|
| `pua chat` | å¯åŠ¨äº¤äº’æ¨¡å¼ |
| `pua prompt "é—®é¢˜"` | å•æ¬¡æé—® |
| `pua config` | é‡æ–°é…ç½® |
| `pua config --show` | æŸ¥çœ‹é…ç½® |

### äº¤äº’æ¨¡å¼å†…å‘½ä»¤

| å‘½ä»¤ | è¯´æ˜ |
|------|------|
| `/help` | æ˜¾ç¤ºå¸®åŠ© |
| `/clear` | æ¸…ç©ºå†å² |
| `/history` | æŸ¥çœ‹å†å² |
| `/exit` | é€€å‡º |

## é…ç½®è¯´æ˜

### æŸ¥çœ‹å½“å‰é…ç½®

```bash
pua config --show
```

### é‡æ–°é…ç½®

```bash
pua config
```

## æ”¯æŒçš„ AI æœåŠ¡æä¾›å•†

| Provider | ä»£ç  | é»˜è®¤æ¨¡å‹ | è¯´æ˜ |
|----------|------|----------|------|
| æ™ºè°± AI | `zhipu` | `glm-4.7` | å›½äº§ï¼Œç¨³å®š |
| OpenAI | `openai` | `gpt-4o` | å›½é™…é€šç”¨ |

## å‘½ä»¤è¡Œé€‰é¡¹

| é€‰é¡¹ | è¯´æ˜ |
|------|------|
| `--provider <zhipu\|openai>` | AI æœåŠ¡æä¾›å•† |
| `--role <boss\|employee>` | è§’è‰²æ¨¡å¼ |
| `--model <model>` | æ¨¡å‹åç§° |
| `--severity <mild\|medium\|extreme>` | PUA å¼ºåº¦ |

## ä½¿ç”¨åœºæ™¯

### è¶£å‘³å¯¹è¯

ä½“éªŒ"èŒåœº PUA"çš„è¶£å‘³äº’åŠ¨ï¼š

```bash
pua chat --role boss --severity extreme
```

### AI å·¥ä½œæµ

åœ¨è„šæœ¬ä¸­ä½œä¸ºæç¤ºè¯ç”Ÿæˆå™¨ï¼š

```bash
# ç”Ÿæˆæ‰¹è¯„æ€§æç¤º
critique=$(pua prompt --role boss "ä»£ç è´¨é‡å·®")

# ä¼ é€’ç»™å…¶ä»–å·¥å…·
echo "$critique" | your-ai-tool
```

## å¼€å‘

```bash
# å®‰è£…ä¾èµ–
npm install

# å¼€å‘æ¨¡å¼
npm run dev

# æ„å»º
npm run build
```

## é…ç½®æ–‡ä»¶ä½ç½®

- **Windows**: `%APPDATA%\pua-cli\config.json`
- **Linux/macOS**: `~/.config/pua-cli/config.json`

## è·å– API Key

### æ™ºè°± AIï¼ˆæ¨èï¼‰

- è®¿é—® [bigmodel.cn](https://bigmodel.cn/)
- å®Œæˆå®åè®¤è¯åå…è´¹è·å– 2000 ä¸‡ tokens
- åœ¨æ§åˆ¶å°å¤åˆ¶ API Key

### OpenAI

- è®¿é—® [platform.openai.com](https://platform.openai.com/)
- æ³¨å†Œè´¦å·å¹¶åœ¨ API Keys é¡µé¢åˆ›å»º Key

## å…è´£å£°æ˜

æœ¬å·¥å…·ä»…ä¾›å¨±ä¹å’Œå­¦ä¹ ä½¿ç”¨ï¼Œé€šè¿‡è§’è‰²æ‰®æ¼”çš„æ–¹å¼å¯¹èŒåœº PUA ç°è±¡è¿›è¡Œè®½åˆºå’Œè°ƒä¾ƒã€‚

## About

æœ¬é¡¹ç›®æ˜¯ä¸€ä¸ª **CLI å·¥å…·å¼€å‘å­¦ä¹ é¡¹ç›®**ï¼Œæ—¨åœ¨é€šè¿‡å®é™…å¼€å‘æŒæ¡ä»¥ä¸‹æŠ€èƒ½ï¼š

- âœ… Node.js CLI å·¥å…·å¼€å‘
- âœ… TypeScript ç±»å‹ç³»ç»Ÿåº”ç”¨
- âœ… å·¥å‚æ¨¡å¼å’ŒæŠ½è±¡è®¾è®¡
- âœ… æµå¼æ•°æ®å¤„ç†
- âœ… é…ç½®ç®¡ç†ç³»ç»Ÿ
- âœ… äº¤äº’å¼å‘½ä»¤è¡Œç•Œé¢
- âœ… LLM API é›†æˆ

### GitHub

- **Repository**: [https://github.com/ava-agent/pua-cli](https://github.com/ava-agent/pua-cli)
- **Author**: @ava-agent
- **License**: MIT

---

## License

MIT
